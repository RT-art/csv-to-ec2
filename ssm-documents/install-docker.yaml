schemaVersion: "2.2"
description: "Install Docker and output completion message on Amazon Linux2023 (Idempotent)"
mainSteps:
  - action: "aws:runShellScript"
    name: "InstallDocker"
    inputs:
      runCommand:
        - "set -e"
        - "if ! command -v docker &> /dev/null; then sudo dnf install -y docker; fi"
        - "sudo systemctl enable docker.service"
        - "sudo systemctl start docker.service"
        - "if ! id -nG 'ec2-user' | grep -qw 'docker'; then sudo usermod -a -G docker ec2-user; fi"
        - "echo 'Docker setup complete.'"
